<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registro Attivit√† Team</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/exceljs@4.3.0/dist/exceljs.min.js"></script>
<script src="https://alcdn.msauth.net/browser/2.26.0/js/msal-browser.min.js"></script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
:root {
  --primary: #1F4E79;
  --secondary: #2E86C1;
  --success: #27AE60;
  --warning: #F39C12;
  --danger: #E74C3C;
  --light: #F8F9FA;
  --gray: #6C757D;
  --border: #DEE2E6;
}
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  padding: 20px;
}
.container {
  max-width: 1400px;
  margin: 0 auto;
  background: white;
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.2);
  overflow: hidden;
}
.header {
  background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
  color: white;
  padding: 30px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.header h1 { font-size: 28px; font-weight: 700; }
.header-right { display: flex; gap: 20px; align-items: center; flex-wrap: wrap; }
.user-info { display: flex; align-items: center; gap: 10px; background: rgba(255,255,255,0.2); padding: 10px 15px; border-radius: 8px; }
.btn {
  padding: 10px 20px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.3s ease;
  display: inline-flex;
  align-items: center;
  gap: 8px;
}
.btn-primary { background: var(--primary); color: white; }
.btn-primary:hover { background: #163a52; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(31,78,121,0.3); }
.btn-secondary { background: var(--secondary); color: white; }
.btn-secondary:hover { background: #1e5a8e; }
.btn-success { background: var(--success); color: white; }
.btn-success:hover { background: #1e7e34; }
.btn-danger { background: var(--danger); color: white; }
.btn-danger:hover { background: #c0392b; }
.btn:disabled { opacity: 0.6; cursor: not-allowed; }
.nav-tabs { display: flex; background: var(--light); border-bottom: 2px solid var(--border); overflow-x: auto; }
.nav-tab {
  padding: 15px 25px;
  cursor: pointer;
  border: none;
  background: none;
  font-weight: 600;
  color: var(--gray);
  transition: all 0.3s ease;
  white-space: nowrap;
  border-bottom: 3px solid transparent;
  margin-bottom: -2px;
}
.nav-tab:hover { color: var(--primary); background: rgba(31,78,121,0.05); }
.nav-tab.active { color: var(--primary); border-bottom-color: var(--primary); }
.content { padding: 30px; }
.dashboard { display: none; }
.dashboard.active { display: block; }
.filter-bar {
  background: var(--light);
  padding: 20px;
  border-radius: 10px;
  margin-bottom: 20px;
  display: flex;
  gap: 15px;
  align-items: center;
  flex-wrap: wrap;
}
.filter-bar label { font-weight: 600; color: var(--primary); font-size: 14px; }
.filter-bar select { padding: 8px 12px; border: 2px solid var(--border); border-radius: 6px; font-family: inherit; font-size: 14px; cursor: pointer; }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
.stat-card { background: white; border: 2px solid var(--border); border-radius: 10px; padding: 20px; text-align: center; transition: all 0.3s ease; }
.stat-card:hover { border-color: var(--primary); box-shadow: 0 5px 15px rgba(31,78,121,0.1); }
.stat-card i { font-size: 32px; color: var(--primary); margin-bottom: 10px; }
.stat-card .label { color: var(--gray); font-size: 12px; text-transform: uppercase; margin-bottom: 5px; }
.stat-card .value { font-size: 28px; font-weight: 700; color: var(--primary); }
.charts-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; }
.chart-container { background: white; border: 2px solid var(--border); border-radius: 10px; padding: 20px; }
.chart-container h3 { margin-bottom: 15px; color: var(--primary); }
</style>
</head>
<body>
<div class="container">
<div class="header">
<div><h1><i class="fas fa-tasks"></i> Registro Attivit√† Team</h1></div>
<div class="header-right">
<div class="user-info"><i class="fas fa-user-circle"></i><span>Team</span></div>
<button class="btn btn-secondary" onclick="loginToOneDrive()" id="onedrive-btn"><i class="fas fa-cloud"></i> OneDrive</button>
<span class="onedrive-status" id="onedrive-status"></span>
<button class="btn btn-secondary" onclick="exportToExcel()"><i class="fas fa-file-excel"></i> Excel</button>
<button class="btn btn-secondary" onclick="exportToCSV()"><i class="fas fa-download"></i> CSV</button>
</div>
</div>
<div class="nav-tabs">
<button class="nav-tab active" onclick="switchTab('dashboard',this)"><i class="fas fa-chart-line"></i> Dashboard</button>
<button class="nav-tab" onclick="switchTab('progetti',this)"><i class="fas fa-folder"></i> Progetti</button>
<button class="nav-tab" onclick="switchTab('gennaio',this)"><i class="fas fa-calendar"></i> Gennaio</button>
<button class="nav-tab" onclick="switchTab('febbraio',this)">Febbraio</button>
<button class="nav-tab" onclick="switchTab('marzo',this)">Marzo</button>
<button class="nav-tab" onclick="switchTab('aprile',this)">Aprile</button>
<button class="nav-tab" onclick="switchTab('maggio',this)">Maggio</button>
<button class="nav-tab" onclick="switchTab('giugno',this)">Giugno</button>
<button class="nav-tab" onclick="switchTab('luglio',this)">Luglio</button>
<button class="nav-tab" onclick="switchTab('agosto',this)">Agosto</button>
<button class="nav-tab" onclick="switchTab('settembre',this)">Settembre</button>
<button class="nav-tab" onclick="switchTab('ottobre',this)">Ottobre</button>
<button class="nav-tab" onclick="switchTab('novembre',this)">Novembre</button>
<button class="nav-tab" onclick="switchTab('dicembre',this)">Dicembre</button>
</div>
<div class="content">
<div id="dashboard" class="dashboard active">
<h2 style="color:var(--primary);margin-bottom:20px;">üìä Dashboard</h2>
<div class="filter-bar">
<label>Anno:</label>
<select id="year-filter" onchange="updateDashboard()"><option value="">Tutti gli anni</option></select>
<label>Persona:</label>
<select id="person-filter" onchange="updateDashboard()">
<option value="">Tutte le persone</option>
<option value="Francesco Marzaro">Francesco Marzaro</option>
<option value="Roberto Zampieri">Roberto Zampieri</option>
<option value="Saverio Manduca">Saverio Manduca</option>
</select>
</div>
<div class="stats-grid">
<div class="stat-card"><i class="fas fa-tasks"></i><div class="label">Attivit√† Totali</div><div class="value" id="stat-activities">0</div></div>
<div class="stat-card"><i class="fas fa-check-circle"></i><div class="label">Completate</div><div class="value" id="stat-completed">0</div></div>
<div class="stat-card"><i class="fas fa-clock"></i><div class="label">Ore Pianificate</div><div class="value" id="stat-hours">0</div></div>
<div class="stat-card"><i class="fas fa-hourglass-end"></i><div class="label">Ore Effettive</div><div class="value" id="stat-hours-actual">0</div></div>
<div class="stat-card"><i class="fas fa-euro-sign"></i><div class="label">Costo Totale</div><div class="value currency" id="stat-cost">‚Ç¨0</div></div>
</div>
<div class="charts-grid">
<div class="chart-container"><h3>Ore per Persona</h3><canvas id="hoursByPersonChart"></canvas></div>
<div class="chart-container"><h3>Stato Attivit√†</h3><canvas id="statusChart"></canvas></div>
<div class="chart-container" style="grid-column:1/-1;"><h3>Andamento Mensile</h3><canvas id="monthlyChart"></canvas></div>
</div>
</div>
<div id="progetti" class="dashboard">
<h2 style="color:var(--primary);margin-bottom:20px;">üìÅ Gestione Progetti</h2>
<div class="form-section" style="background:var(--light);padding:20px;border-radius:10px;margin-bottom:30px;">
<h3 style="color:var(--primary);margin-bottom:15px;">Aggiungi Nuovo Progetto</h3>
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:15px;">
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Nome Cliente</label><input type="text" id="project-client" placeholder="es. Acme Corporation" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Nome Progetto</label><input type="text" id="project-name" placeholder="es. Website Redesign" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Responsabile</label><select id="project-person" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"><option value="">Seleziona...</option><option value="Francesco Marzaro">Francesco Marzaro</option><option value="Roberto Zampieri">Roberto Zampieri</option><option value="Saverio Manduca">Saverio Manduca</option></select></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Budget Ore</label><input type="number" id="project-budget" placeholder="es. 120" min="0" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Tariffa ‚Ç¨/h</label><input type="number" id="project-rate" placeholder="35" value="35" min="0" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Scadenza</label><input type="date" id="project-deadline" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Stato</label><select id="project-status" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"><option value="Attivo">Attivo</option><option value="Pianificato">Pianificato</option><option value="Completato">Completato</option><option value="In Pausa">In Pausa</option></select></div>
</div>
<button class="btn btn-success" onclick="addProject()"><i class="fas fa-plus"></i> Aggiungi Progetto</button>
</div>
<div id="projects-list" style="display:flex;gap:20px;overflow-x:auto;padding-bottom:15px;scroll-behavior:smooth;"></div>
</div>
<div id="gennaio" class="dashboard">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
<button onclick="changeMonth(-1)" style="background:var(--primary);color:white;border:none;padding:8px 15px;border-radius:6px;cursor:pointer;"><i class="fas fa-chevron-left"></i></button>
<h2 id="current-month" style="color:var(--primary);">Gennaio</h2>
<button onclick="changeMonth(1)" style="background:var(--primary);color:white;border:none;padding:8px 15px;border-radius:6px;cursor:pointer;"><i class="fas fa-chevron-right"></i></button>
</div>
<div class="form-section" style="background:var(--light);padding:20px;border-radius:10px;margin-bottom:30px;">
<h3 style="color:var(--primary);margin-bottom:15px;">Aggiungi Attivit√†</h3>
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:15px;">
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Data</label><input type="date" id="activity-date" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Persona</label><select id="activity-person" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"><option value="">Seleziona...</option><option value="Francesco Marzaro">Francesco Marzaro</option><option value="Roberto Zampieri">Roberto Zampieri</option><option value="Saverio Manduca">Saverio Manduca</option></select></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Progetto</label><select id="activity-project" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"><option value="">Seleziona...</option></select></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Attivit√†</label><input type="text" id="activity-name" placeholder="Descrizione del task" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Link Cartella</label><input type="url" id="activity-link" placeholder="https://..." style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Ore Pianificate</label><input type="number" id="activity-hours-plan" placeholder="0" min="0" step="0.5" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Ore Effettive</label><input type="number" id="activity-hours-actual" placeholder="0" min="0" step="0.5" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Avanzamento %</label><input type="range" id="activity-progress" min="0" max="100" value="0" style="padding:10px;"><span id="progress-value">0%</span></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Stato</label><select id="activity-status" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"><option value="Da Iniziare">Da Iniziare</option><option value="In Corso">In Corso</option><option value="Completato">Completato</option><option value="In Attesa">In Attesa</option></select></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Note</label><textarea id="activity-notes" placeholder="Note aggiuntive..." style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;resize:vertical;min-height:80px;"></textarea></div>
</div>
<button class="btn btn-success" onclick="addActivity()"><i class="fas fa-plus"></i> Aggiungi Attivit√†</button>
</div>
<div class="month-stats" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:15px;margin-bottom:20px;background:var(--light);padding:15px;border-radius:10px;">
<div style="text-align:center;"><div style="color:var(--gray);font-size:12px;margin-bottom:5px;">Attivit√†</div><div style="font-size:20px;font-weight:700;color:var(--primary);" id="month-total">0</div></div>
<div style="text-align:center;"><div style="color:var(--gray);font-size:12px;margin-bottom:5px;">Ore Pianificate</div><div style="font-size:20px;font-weight:700;color:var(--primary);" id="month-hours-plan">0</div></div>
<div style="text-align:center;"><div style="color:var(--gray);font-size:12px;margin-bottom:5px;">Ore Effettive</div><div style="font-size:20px;font-weight:700;color:var(--primary);" id="month-hours-actual">0</div></div>
<div style="text-align:center;"><div style="color:var(--gray);font-size:12px;margin-bottom:5px;">Costo</div><div style="font-size:20px;font-weight:700;color:var(--success);" id="month-cost">‚Ç¨0</div></div>
</div>
<div style="overflow-x:auto;border:2px solid var(--border);border-radius:10px;margin-bottom:20px;">
<table style="width:100%;border-collapse:collapse;">
<thead style="background:var(--primary);color:white;">
<tr><th style="padding:15px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;">Data</th><th style="padding:15px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;">Persona</th><th style="padding:15px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;">Cliente</th><th style="padding:15px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;">Progetto</th><th style="padding:15px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;">Attivit√†</th><th style="padding:15px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;">Link</th><th style="padding:15px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;">Ore Plan</th><th style="padding:15px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;">Ore Eff</th><th style="padding:15px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;">Costo</th><th style="padding:15px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;">Avanzamento</th><th style="padding:15px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;">Stato</th><th style="padding:15px;text-align:left;font-weight:600;font-size:13px;text-transform:uppercase;">Azioni</th></tr>
</thead>
<tbody id="activities-table" style="background:white;">
<tr><td colspan="12" style="padding:40px;text-align:center;color:var(--gray);"><i class="fas fa-inbox" style="font-size:32px;opacity:0.5;"></i><p style="margin-top:10px;">Nessuna attivit√†</p></td></tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div id="edit-project-modal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:1000;align-items:center;justify-content:center;">
<div style="background:white;border-radius:12px;padding:30px;max-width:500px;width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,0.3);">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
<h2 style="color:var(--primary);">Modifica Progetto</h2>
<button onclick="closeProjectModal()" style="background:none;border:none;font-size:24px;cursor:pointer;color:var(--gray);">√ó</button>
</div>
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;">
<input type="hidden" id="edit-project-id">
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Nome Cliente</label><input type="text" id="edit-project-client" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Nome Progetto</label><input type="text" id="edit-project-name" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Responsabile</label><select id="edit-project-person" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"><option value="Francesco Marzaro">Francesco Marzaro</option><option value="Roberto Zampieri">Roberto Zampieri</option><option value="Saverio Manduca">Saverio Manduca</option></select></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Budget Ore</label><input type="number" id="edit-project-budget" min="0" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Tariffa ‚Ç¨/h</label><input type="number" id="edit-project-rate" min="0" value="35" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Scadenza</label><input type="date" id="edit-project-deadline" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Stato</label><select id="edit-project-status" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"><option value="Attivo">Attivo</option><option value="Pianificato">Pianificato</option><option value="Completato">Completato</option><option value="In Pausa">In Pausa</option></select></div>
</div>
<div style="margin-top:20px;display:flex;gap:10px;">
<button class="btn btn-success" onclick="saveProjectEdit()">Salva</button>
<button class="btn btn-secondary" onclick="closeProjectModal()">Annulla</button>
</div>
</div>
</div>
<div id="edit-modal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);z-index:1000;align-items:center;justify-content:center;">
<div style="background:white;border-radius:12px;padding:30px;max-width:500px;width:90%;max-height:90vh;overflow-y:auto;box-shadow:0 20px 60px rgba(0,0,0,0.3);">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
<h2 style="color:var(--primary);">Modifica Attivit√†</h2>
<button onclick="closeModal()" style="background:none;border:none;font-size:24px;cursor:pointer;color:var(--gray);">√ó</button>
</div>
<div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;">
<input type="hidden" id="edit-id">
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Data</label><input type="date" id="edit-date" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Persona</label><select id="edit-person" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"><option value="Francesco Marzaro">Francesco Marzaro</option><option value="Roberto Zampieri">Roberto Zampieri</option><option value="Saverio Manduca">Saverio Manduca</option></select></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Progetto</label><select id="edit-project" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></select></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Attivit√†</label><input type="text" id="edit-name" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Link</label><input type="url" id="edit-link" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Ore Pianificate</label><input type="number" id="edit-hours-plan" min="0" step="0.5" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Ore Effettive</label><input type="number" id="edit-hours-actual" min="0" step="0.5" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Avanzamento %</label><input type="range" id="edit-progress" min="0" max="100" style="padding:10px;"></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Stato</label><select id="edit-status" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;"><option value="Da Iniziare">Da Iniziare</option><option value="In Corso">In Corso</option><option value="Completato">Completato</option><option value="In Attesa">In Attesa</option></select></div>
<div style="display:flex;flex-direction:column;"><label style="font-weight:600;color:var(--primary);margin-bottom:5px;font-size:14px;">Note</label><textarea id="edit-notes" style="padding:10px;border:2px solid var(--border);border-radius:6px;font-family:inherit;font-size:14px;resize:vertical;min-height:80px;"></textarea></div>
</div>
<div style="margin-top:20px;display:flex;gap:10px;">
<button class="btn btn-success" onclick="saveEdit()">Salva</button>
<button class="btn btn-secondary" onclick="closeModal()">Annulla</button>
</div>
</div>
</div>
</body>
</html>
<script>
<script>
const msalConfig={auth:{clientId:"2a14e77e-36fc-4e4a-b7c9-cd2450be114e",authority:"
